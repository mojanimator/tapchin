import{S as B}from"./Scaffold-D_ifbLkl.js";import{_ as P}from"./SecondaryButton-Bn4R_gjB.js";import{_ as L}from"./PrimaryButton-Fk5jf8Nh.js";import{j as V,i as n,o as i,c as p,w as f,e as l,t as s,f as c,a as t,b as d,g as F,k as g,A as T,n as N,p as S,h as j,F as z,v as E}from"./app-DeJr7fNP.js";import{L as D}from"./LoadingIcon-8dx7WYGr.js";import{I as M}from"./Footer-BYUJXMx0.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as U,a as O,b as Z}from"./UserIcon-0EqPaU23.js";import{r as A}from"./PlayIcon-CGUysmnM.js";import{r as Y}from"./PauseIcon-DZ4vp-XW.js";import"./Alert-CDDSmLjy.js";import"./ApplicationLogo-CV6pwTdm.js";const $={data(){return{html:null,stop:!1,timer:0,timerPercent:0,auto_view:this.$page.props.auto_view,error:null,data:null,available_sites:0,hiddenProp:null,intervalId:null,sites:[],loading:!1,params:{page:0,search:null,order_by:null,dir:null}}},components:{Scaffold:B,Image:M,Link:V,EyeIcon:U,CurrencyDollarIcon:O,LoadingIcon:D,PrimaryButton:L,SecondaryButton:P,UserIcon:Z,PlayIcon:A,PauseIcon:Y},beforeUnmount(){clearInterval(this.intervalId)},created(){window.addEventListener("beforeunload",()=>{clearInterval(this.intervalId)})},mounted(){this.hiddenProp=this.getHiddenProp(),this.$page.props.error_message||this.isLoading(!0),this.data=this.$page.props.data,this.available_sites=this.$page.props.available_sites,this.setScroll(this.$refs.loader.$el),this.getData()},methods:{afterCommision(e){if(!e||e==0)return e;const r=this.$page.props.commission,h=Math.floor(r*e/100);return e-h},startTimer(e){this.isLoading(!1),this.timer=0,e.target;let r=this.$page.props.reward_second;this.intervalId=setInterval((function(){!this.tabIsVisible()&&!this.stop&&(this.timer++,this.timerPercent=Math.floor(this.timer/r*100)),this.timer>=r&&(clearInterval(this.intervalId),this.addTransaction())}).bind(this),1e3)},addTransaction(){this.$page.props.data&&(this.isLoading(!0),window.axios.post(route("transaction.item.view"),{id:this.data.id,type:this.data.type,auto_view:this.auto_view}).then(e=>{this.isLoading(!1),e.data&&e.data.message&&(this.showToast("success",e.data.message),this.sleep(3e3).then(()=>{e.data.next&&this.auto_view&&this.$inertia.visit(route("item",{type:e.data.next.type,id:e.data.next.id}),{method:"get"})}))}).catch(e=>{this.isLoading(!1),this.error=this.getErrors(e),this.showToast("danger",this.error),e.response&&e.response.data&&this.sleep(3e3).then(()=>{e.response.data.next&&this.auto_view&&this.$inertia.visit(route("item",{type:e.response.data.next.type,id:e.response.data.next.id}),{method:"get"})})}).finally(()=>{this.isLoading(!1)}))},tabIsVisible(){const e=this.hiddenProp;return e?document[e]:!1},getHiddenProp(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var r=0;r<e.length;r++)if(e[r]+"Hidden"in document)return e[r]+"Hidden";return null},getData(){this.total>0&&this.total<=this.sites.length||(this.loading=!0,window.axios.get(route("item.search"),{params:this.params}).then(e=>{this.sites=this.sites.concat(e.data.data),this.total=e.data.total,this.params.page=e.data.current_page+1}).catch(e=>{this.error=this.getErrors(e),this.showToast("danger",this.error)}).finally(()=>{this.loading=!1}))},setScroll(e){window.onscroll=()=>{let r=e.offsetTop,h=e.offsetTop+e.offsetHeight,m=window.pageYOffset+window.innerHeight,o=window.pageYOffset;m+300>r&&o<h+200&&!this.loading&&this.getData()}}}},R={key:0},q=["content"];const G={class:"flex justify-center pt-24"},J={class:"w-full rounded-lg overflow-x-hidden shadow-lg max-w-6xl xs:mx-2 md:mx-4 blur-xs opacity-75 bg-white backdrop-filter"},K={key:0,class:"text-center flex flex-col font-bold p-4 text-danger text-lg"},Q={class:"text-gray-900"},W={key:1,class:"flex flex-col"},X={class:"px-4 py-2 text-white bg-primary-500"},ee={key:0,class:"border-t p-4 flex flex-col space-y-4 m-4"},te={key:0,class:"text-sm flex flex-wrap"},se={class:"text-gray-500"},oe=t("span",{class:"border-s mx-2"},null,-1),ae={class:"text-gray-500"},re={class:"text-sm"},ie={class:"text-gray-500"},ne={class:"text-sm"},le={class:"text-gray-500"},ce={class:"flex flex-wrap sm:flex-nowrap items-center justify-between text-white bg-primary-500 px-4 py-2"},de={class:"flex flex-wrap w-full justify-start items-center text-sm"},_e={class:"flex items-center"},he={class:"px-1"},pe={class:"px-1"},fe=t("div",{class:"border-s py-4 md:mx-6 mx-1"},null,-1),me={class:"flex items-center"},ue={class:"px-1"},ge={class:"px-1"},xe=t("div",{class:"border-s py-4 md:mx-6 mx-1"},null,-1),we={class:"flex items-center"},ve={class:"px-1"},ye={class:"px-1"},be=t("div",{class:"border-s py-4 md:mx-6 mx-1"},null,-1),ke={class:"flex items-center",dir:"ltr"},Ce={class:"inline-block px-2 hover:cursor-pointer",for:"auto_view"},Ie={class:"text-primary-500 bg-primary-100 rounded-lg p-2 justify-center flex text-xs"},Be={class:"mx-1"},Pe={class:"mx-1"},Le={class:"flex"},Ve={class:"shadow w-full bg-grey-light m-2 bg-gray-200 rounded-full"},Fe={class:"animate-bounce"},Te=["src"];const Ne={class:"flex justify-center p-5 max-w-7xl mx-auto border-t mt-5"},Se={class:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-2 max-w-6xl"},je={class:"p-2 text-sm text-gray-700"},ze={class:"px-4 py-1 text-sm text-gray-400"},Ee={class:"px-4 py-1 text-sm text-gray-400"},De=t("hr",{class:"border-gray-200"},null,-1),Me={class:"flex justify-around items-center p-4 text-sm text-gray-500"},He={class:"flex items-center"},Ue={class:"px-1"},Oe={class:"px-1"},Ze=t("div",{class:"border-s py-2"},null,-1),Ae={class:"flex items-center"},Ye={class:"px-1"},$e={class:"px-1"},Re={key:0,class:"absolute text-gray-500 rounded-lg text-white bg-rose-500 p-1 px-2 m-2 end-0 top-0 shadow-lg"};function qe(e,r,h,m,o,_){const u=n("Link"),x=n("EyeIcon"),w=n("UserIcon"),v=n("CurrencyDollarIcon"),y=n("PlayIcon"),b=n("PauseIcon"),Ge=n("PrimaryButton"),k=n("Image"),C=n("LoadingIcon"),I=n("Scaffold");return i(),p(I,{"navbar-theme":"light"},{header:f(()=>[o.data?(i(),l("title",R,s(o.data.name),1)):c("",!0),o.data?(i(),l("meta",{key:1,name:"description",content:o.data.description},null,8,q)):c("",!0)]),default:f(()=>[c("",!0),t("section",G,[t("div",J,[e.$page.props.error_message?(i(),l("div",K,[t("div",Q,s(e.$page.props.error_message),1),d(u,{href:e.$page.props.error_link,class:"my-4"},{default:f(()=>[F(s(e.__("return")),1)]),_:1},8,["href"])])):o.data?(i(),l("div",W,[t("div",X,s(o.data.name),1),o.data?(i(),l("div",ee,[o.data.owner?(i(),l("p",te,[t("span",se,s(e.__("owner"))+": ",1),t("span",null,s(o.data.owner.fullname),1),oe,t("span",ae,s(e.__("phone"))+": ",1),t("span",null,s(o.data.owner.phone),1)])):c("",!0),t("p",re,[t("span",ie,s(e.__("tags"))+": ",1),t("span",null,s(o.data.tags),1)]),t("p",ne,[t("span",le,s(e.__("description"))+": ",1),t("span",null,s(o.data.description),1)])])):c("",!0),t("div",ce,[t("div",de,[t("div",_e,[d(x,{class:"w-4 h-4"}),t("span",he,s(e.__("view"))+":",1),t("span",pe,s(o.data.view),1)]),fe,t("div",me,[d(w,{class:"w-4 h-4"}),t("span",ue,s(e.__("viewer"))+":",1),t("span",ge,s(o.data.viewer),1)]),xe,t("div",we,[d(v,{class:"w-4 h-4"}),t("span",ve,s(e.__("reward"))+":",1),t("span",ye,s(e.asPrice(o.data.view_reward))+" "+s(e.__("currency_symbol")),1)]),be,t("div",ke,[g(t("input",{"onUpdate:modelValue":r[0]||(r[0]=a=>o.auto_view=a),onChange:r[1]||(r[1]=a=>o.auto_view&&o.timer>=e.$page.props.reward_second?_.startTimer(e.$refs.iframe):null),class:"mx-2 h-3.5 w-8 appearance-none rounded-[0.4375rem] bg-neutral-300 before:pointer-events-none before:absolute before:h-3.5 before:w-3.5 before:rounded-full before:bg-transparent before:content-[''] after:absolute after:z-[2] after:-mt-[0.1975rem] after:h-5 after:w-5 after:rounded-full after:border-none after:bg-neutral-100 after:shadow-[0_0px_3px_0_rgb(0_0_0_/_7%),_0_2px_2px_0_rgb(0_0_0_/_4%)] after:transition-[background-color_0.2s,transform_0.2s] after:content-[''] checked:bg-success checked:after:absolute checked:after:z-[2] checked:after:-mt-[3px] checked:after:ml-[1.0625rem] checked:after:h-5 checked:after:w-5 checked:after:rounded-full checked:after:border-none checked:after:bg-success checked:after:shadow-[0_3px_1px_-2px_rgba(0,0,0,0.2),_0_2px_2px_0_rgba(0,0,0,0.14),_0_1px_5px_0_rgba(0,0,0,0.12)] checked:after:transition-[background-color_0.2s,transform_0.2s] checked:after:content-[''] hover:cursor-pointer focus:outline-none focus:ring-0 focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[3px_-1px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-5 focus:after:w-5 focus:after:rounded-full focus:after:content-[''] checked:focus:border-success checked:focus:bg-success checked:focus:before:ml-[1.0625rem] checked:focus:before:scale-100 checked:focus:before:shadow-[3px_-1px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s]",type:"checkbox",role:"switch",id:"auto_view"},null,544),[[T,o.auto_view]]),t("label",Ce,s(e.__("auto_view")),1)]),t("div",null,[t("div",{onClick:r[2]||(r[2]=a=>o.stop=!o.stop),class:"rounded-full p-1 mx-1 border cursor-pointer hover:bg-gray-400"},[o.stop?(i(),p(y,{key:0,class:"w-5 h-5"})):(i(),p(b,{key:1,class:"w-5 h-5"}))])])]),t("div",Ie,[t("span",Be,s(e.__("viewable"))+":",1),t("span",Pe,s(o.available_sites>0?o.available_sites-1:0),1)])]),t("div",Le,[t("div",Ve,[t("div",{class:N(["bg-primary-500 rounded text-xs leading-none py-[.1rem] text-center text-white duration-300",{" animate-pulse":o.timerPercent<100}]),style:S(`width: ${o.timerPercent}%`)},[t("span",Fe,s(o.timer),1)],6)])]),t("iframe",{ref:"iframe",class:"w-full min-h-[24rem]",src:e.$page.props.data.link,onLoadOnce:r[3]||(r[3]=(...a)=>_.startTimer&&_.startTimer(...a))},`\r
\r
          `,40,Te)])):c("",!0)])]),c("",!0),t("section",Ne,[t("div",Se,[(i(!0),l(z,null,j(o.sites,(a,Je)=>(i(),p(u,{href:e.route("item",{type:a.type,id:a.id}),class:"flex-col relative items-stretch cursor-pointer hover:scale-[101%] duration-300 rounded-lg overflow-hidden shadow-lg"},{default:f(()=>[d(k,{src:e.route(`storage.${a.type}s`)+`/${a.id}.jpg`,classes:"object-cover h-48 rounded-lg  w-full"},null,8,["src"]),t("div",je,s(e.cropText(a.name,30)),1),t("div",ze,s(e.getCategory(a.category_id)),1),t("div",Ee,s(e.__(a.type)),1),De,t("div",Me,[t("div",He,[t("span",Ue,s(e.__("view"))+":",1),t("span",Oe,s(a.view),1)]),Ze,t("div",Ae,[t("span",Ye,s(e.__("reward"))+":",1),t("span",$e,s(a.status=="active"&&a.charge>a.view_fee?e.asPrice(_.afterCommision(a.view_fee)):0)+" "+s(e.__("currency_symbol")),1)]),a.status=="active"&&a.charge>a.view_fee?(i(),l("div",Re,s(`${_.afterCommision(a.view_fee)} ⭐️`),1)):c("",!0)])]),_:2},1032,["href"]))),256))])]),g(d(C,{ref:"loader",type:"linear"},null,512),[[E,o.loading]])]),_:1})}const lt=H($,[["render",qe]]);export{lt as default};
