import{_ as y}from"./TextInput-K5DGNw4r.js";import{L as I}from"./LoadingIcon-PyLCRR-O.js";import{o as s,e as o,a as i,i as a,n as m,c as p,f as d,t as u,b as l,w as _,k as f,v as k,G as b,E as M}from"./app-COCv_6FM.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as S,d as L}from"./Footer-B5OFFhHa.js";import{r as T}from"./ChevronUpIcon-BtLkJPMB.js";import{r as Q}from"./PlusIcon-RnmXorVm.js";import{r as V}from"./MinusIcon-7FMvIveB.js";function j(e,t){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])}const D={name:"CartItemButton",data(){return{inCartOld:0,inCart:0,show:!1,modal:null,loading:!1,cart:this.$page.props.cart}},expose:["update:cart"],props:["productId","inShop","link"],components:{TextInput:y,ChevronDownIcon:S,ChevronUpIcon:T,ShoppingCartIcon:L,PlusIcon:Q,MinusIcon:V,LoadingIcon:I,XMarkIcon:j},mounted(){this.setInCartQty(),this.inCartOld=this.inCart,this.emitter.on("updateCart",e=>{this.cart=e,this.setInCartQty()})},methods:{setInCartQty(){if(this.inCart=0,this.cart&&this.cart.orders&&this.cart.orders.length>0){for(let e in this.cart.orders)for(let t in this.cart.orders[e].shipments)for(let c in this.cart.orders[e].shipments[t].items)if(this.cart.orders[e].shipments[t].items[c].cart_item.variation_id==this.productId){this.inCart=this.cart.orders[e].shipments[t].items[c].cart_item.qty,this.inCart=this.inCart?parseFloat(this.inCart):0;break}}},isInt(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e},plus(){this.isInt(this.inCart)?this.inCart++:this.inCart=0},minus(){this.isInt(this.inCart)&&this.inCart>1?this.inCart--:this.inCart=0},edit(e){this.loading=!0,window.axios.patch(this.link||route("cart.update"),e,{}).then(t=>{t.data&&t.data.message&&this.showToast("success",t.data.message),t.data.cart&&this.updateCart(t.data.cart),this.show=!1}).catch(t=>{this.error=this.getErrors(t),t.response&&t.response.data,this.showToast("danger",this.error)}).finally(()=>{this.setInCartQty(),this.loading=!1})}}},E={class:"flex flex-col"},N={class:"flex"},P={key:1,class:"mx-2 font-bold text-primary-700"},X={key:0},q={class:"my-2 flex justify-center items-stretch text-primary-500"};function F(e,t,c,O,r,h){const C=a("ShoppingCartIcon"),w=a("LoadingIcon"),x=a("XMarkIcon"),g=a("PlusIcon"),v=a("MinusIcon");return s(),o("div",E,[i("div",N,[i("div",{onClick:t[1]||(t[1]=n=>r.show?r.loading?null:h.edit({variation_id:c.productId,qty:r.inCart}):r.show=!0),class:m([r.show?"rounded-s-md":"rounded-md","border grow flex justify-center items-center border-primary-500 text-primary-500 p-2 hover:bg-primary-400 hover:text-white"])},[r.show?d("",!0):(s(),p(C,{key:0,class:m([{"border-e pe-1":r.inCart},"w-7 h-6"])},null,8,["class"])),r.inCart&&!r.show?(s(),o("div",P,u(r.inCart),1)):d("",!0),r.show?(s(),o("div",{key:2,class:"mx-2 text-center",onClick:t[0]||(t[0]=()=>{})},[r.loading?(s(),p(w,{key:1,class:"w-6 h-6 fill-primary-500"})):(s(),o("div",X,u(e.__("accept")),1))])):d("",!0)],2),r.show&&!r.loading?(s(),o("div",{key:0,onClick:t[2]||(t[2]=n=>{r.inCart=r.inCart,r.show=!1}),class:"text-white flex rounded-e-md bg-danger-600 hover:bg-danger-500 hover:text-white"},[l(x,{class:"w-8 mx-2"})])):d("",!0)]),l(M,{name:"fade"},{default:_(()=>[f(i("div",q,[i("div",{onClick:t[3]||(t[3]=n=>h.plus()),class:"items-center flex border rounded-s border-primary-500 hover:bg-primary-500 hover:text-white"},[l(g,{class:"w-6 mx-3"})]),f(i("input",{type:"number",min:"0","onUpdate:modelValue":t[4]||(t[4]=n=>r.inCart=n),class:"flex w-full shrink text-lg p-1 border text-center focus:border-primary-500 border-primary-500 focus:ring-primary-500"},null,512),[[b,r.inCart]]),i("div",{onClick:t[5]||(t[5]=n=>h.minus()),class:"items-center flex border rounded-e border-primary-500 hover:bg-primary-500 hover:text-white"},[l(v,{class:"w-6 mx-3"})])],512),[[k,r.show]])]),_:1})])}const W=B(D,[["render",F],["__scopeId","data-v-5a0ac8f8"]]);export{W as C,j as r};
