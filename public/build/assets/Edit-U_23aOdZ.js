import"./Scaffold-D_ifbLkl.js";import{P as V,r as $}from"./Panel-rs2tkraC.js";import{T as A,Z as B,j as C,i,o as d,c as v,w as a,a as r,t as c,b as n,f as l,l as P,e as h,n as b,p as U}from"./app-DeJr7fNP.js";import{_ as T}from"./Checkbox-BWgqGgzP.js";import"./GuestLayout-B84nh8OP.js";import{_ as E,a as N}from"./InputLabel-C2gVT93H.js";import{_ as F}from"./PrimaryButton-Fk5jf8Nh.js";import{_ as L}from"./TextInput-BUWn7uYR.js";import{R as M}from"./RadioGroup-F_Tqn1wR.js";import{L as X}from"./LoadingIcon-8dx7WYGr.js";import{P as j}from"./Popover-BaS0lwjX.js";import{T as q}from"./Tooltip-CSg56dN2.js";import{_ as z}from"./TagInput-3zOTNi0B.js";import{I as D}from"./ImageUploader-v1nOBbO9.js";import{S as O}from"./Selector-NdNaM2dQ.js";import{P as R}from"./ProvinceCounty-Bztk6mkC.js";import{P as H}from"./PhoneFields-Dp_fguC6.js";import{S as G}from"./SocialFields-hQVy6EEa.js";import{A as Q}from"./Article-CxGv6SoN.js";import{T as Z}from"./TextEditor-7zAQTOol.js";import{U as J}from"./UserSelector-D8GJCG_Y.js";import{A as K}from"./AddressSelector-BkUCPfBb.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as Y}from"./ShoppingBagIcon-zIu7FSuq.js";import{r as ee}from"./Footer-BYUJXMx0.js";import{r as oe}from"./Alert-CDDSmLjy.js";import{r as re}from"./EyeIcon-DI71KuzS.js";import{r as te}from"./FolderPlusIcon-oBdmLyEF.js";import{r as se}from"./Bars2Icon-DNQAv7Yb.js";import{r as ie}from"./LinkIcon-ClPrNMD5.js";import{r as ne}from"./QuestionMarkCircleIcon-jeUFMgsk.js";import{r as ae}from"./Squares2X2Icon-Dviu76Pe.js";import{r as le}from"./SignalIcon-C7ONQsBK.js";import{r as pe}from"./ChatBubbleBottomCenterTextIcon-CovOeJqa.js";import{r as de}from"./PencilIcon-BtrTq_9n.js";import{r as me}from"./CartItemButton-BUsVs_zz.js";import"./ApplicationLogo-CV6pwTdm.js";import"./WrenchScrewdriverIcon-DQFoZ8JW.js";import"./PlusIcon-NsBgz0vi.js";import"./XMarkIcon-CEnCPALs.js";import"./PhoneIcon-CdiwYJQQ.js";import"./MinusIcon-B-7x8Y4K.js";import"./Pagination-VNHzEPuv.js";import"./ChevronRightIcon-9GRJ1f_S.js";import"./Podcast-BxCdE2Ha.js";import"./SpeakerXMarkIcon-CyRlW18-.js";import"./Video-BLyjCQx2.js";import"./Banner-DAn6f3HS.js";import"./MagnifyingGlassIcon--KPgqpVy.js";import"./ChevronUpIcon-DGI4GkYP.js";import"./geosearch.module--3h6cvjB.js";import"./SearchInput-CiaqlZI_.js";import"./MapPinIcon-DUvwgUpM.js";import"./MapIcon-CJ5EAjl4.js";import"./TrashIcon-BFmLih4l.js";const ce={data(){return{data:this.$page.props.data||{},filteredAgencies:this.$page.props.parent_agencies,preloadAddress:null,form:A({id:null,parent_id:null,type_id:null,owner_id:null,name:null,address:null,lat:null,lon:null,location:null,province_id:null,county_id:null,district_id:null,postal_code:null,phone:null,supported_provinces:null}),img:null}},components:{TextEditor:Z,ImageUploader:D,LoadingIcon:X,Head:B,Link:C,HomeIcon:Y,ChevronDownIcon:ee,Panel:V,InputLabel:E,TextInput:L,InputError:N,PrimaryButton:F,RadioGroup:M,UserIcon:oe,EyeIcon:re,Checkbox:T,Popover:j,Tooltip:q,FolderPlusIcon:te,Bars2Icon:se,LinkIcon:ie,TagInput:z,QuestionMarkCircleIcon:ne,Selector:O,Squares2X2Icon:ae,ProvinceCounty:R,PhoneFields:H,SocialFields:G,PencilSquareIcon:$,Article:Q,SignalIcon:le,ChatBubbleBottomCenterTextIcon:pe,PencilIcon:de,UserSelector:J,XMarkIcon:me,AddressSelector:K},created(){},mounted(){this.form.id=this.data.id,this.form.name=this.data.name,this.form.type_id=this.data.type_id,this.form.parent_id=this.data.parent_id,this.form.phone=this.data.phone,this.form.status=this.data.status,this.form.owner=this.data.owner,this.form.owner_id=this.data.owner_id,this.preloadAddress={address:this.data.address,postal_code:this.data.postal_code,province_id:this.data.province_id,county_id:this.data.county_id,district_id:this.data.district_id,lat:this.data.location&&this.data.location.indexOf(",")>-1?this.data.location.split(",")[1]:null,lon:this.data.location&&this.data.location.indexOf(",")>-1?this.data.location.split(",")[0]:null},this.$nextTick(()=>{this.$refs.addressSelector.preload(this.preloadAddress),this.$refs.typeSelector.selecteds=this.form.type_id,this.updateAddress(this.preloadAddress),this.form.type_id&&(this.$refs.parentSelector.selecteds=this.form.parent_id),this.form.type_id==1&&(this.$refs.provincesSelector.selecteds=this.data.access,this.form.supported_provinces=this.data.access)})},methods:{updateFilteredAgencies(){if(!this.form.type_id&&!this.$page.props.agency)return;this.filteredAgencies=[];let e=this.$page.props.agency.level;for(let t in this.$page.props.parent_agencies.filter(m=>m.level>e))if(this.$page.props.parent_agencies[t].level==this.form.type_id-1){let m=this.$page.props.agency_types.filter(u=>u.level==this.form.type_id-1)[0].name;this.filteredAgencies.push({id:this.$page.props.parent_agencies[t].id,name:`${this.$page.props.parent_agencies[t].name} | ${this.__(m)}`})}},updateAddress(e){e=e||{},this.form.address=e.address,this.form.province_id=e.province_id,this.form.county_id=e.county_id,this.form.district_id=e.district_id,this.form.lat=e.lat,this.form.lon=e.lon,this.form.location=`${e.lat},${e.lon}`,this.form.postal_code=this.f2e(e.postal_code),this.updateFilteredAgencies()},submit(){this.form.clearErrors(),this.form.patch(route("admin.panel.agency.update"),{preserveScroll:!1,onSuccess:e=>{this.$page.props.flash.status&&this.showAlert(this.$page.props.flash.status,this.$page.props.flash.message)},onError:()=>{this.showToast("danger",Object.values(this.form.errors).join("<br/>"))},onFinish:e=>{this.$page.props.flash.status&&this.showAlert(this.$page.props.flash.status,this.$page.props.flash.message)}})}}},_e={class:"flex items-center justify-start px-4 py-2 text-primary-500 border-b md:py-4"},fe={class:"text-2xl font-semibold"},he={class:"px-2 md:px-4"},ue={class:"mx-auto md:max-w-2xl mt-6 px-2 md:px-4 py-4 bg-white shadow-md overflow-hidden rounded-lg"},ge={class:"flex flex-col mx-2 col-span-2 w-full px-2"},ye={class:"flex-col m-2 items-center rounded-lg max-w-xs w-full mx-auto"};const ve={class:"my-2"},be={class:"p-3"},we={key:0,class:"my-2"},xe={class:"p-3"},Ie={key:1,class:"my-2"},Se={class:"p-3"},ke={class:"my-2"},Ve={class:"p-3"},$e={class:"my-2"},Ae={class:"p-3"};const Be={class:"my-2"},Ce={key:3,class:"shadow w-full bg-grey-light m-2 bg-gray-200 rounded-full"},Pe={class:"animate-bounce"},Ue={class:"mt-4"},Te={class:"text-lg"};function Ee(e,t,m,u,o,p){const w=i("FolderPlusIcon"),Ne=i("ImageUploader"),Fe=i("InputError"),_=i("Squares2X2Icon"),f=i("Selector"),g=i("Bars2Icon"),y=i("TextInput"),Le=i("XMarkIcon"),Me=i("UserSelector"),x=i("AddressSelector"),I=i("LoadingIcon"),S=i("PrimaryButton"),k=i("Panel");return d(),v(k,null,{header:a(()=>[r("title",null,c(e.__("new_agency")),1)]),content:a(()=>[r("div",_e,[n(w,{class:"h-7 w-7 mx-3"}),r("h1",fe,c(e.__("new_agency")),1)]),r("div",he,[r("div",ue,[r("div",ge,[r("div",ye,[l("",!0)]),r("form",{onSubmit:t[8]||(t[8]=P((...s)=>p.submit&&p.submit(...s),["prevent"]))},[r("div",ve,[n(f,{ref:"typeSelector",data:e.$page.props.agency_types.filter(s=>e.$page.props.agency&&s.level>e.$page.props.agency.level),label:e.__("agency_type"),error:o.form.errors.type_id,onChange:t[0]||(t[0]=s=>p.updateFilteredAgencies()),id:"type_id",modelValue:o.form.type_id,"onUpdate:modelValue":t[1]||(t[1]=s=>o.form.type_id=s)},{append:a(()=>[r("div",be,[n(_,{class:"h-5 w-5"})])]),_:1},8,["data","label","error","modelValue"])]),o.form.type_id==1?(d(),h("div",we,[n(f,{ref:"provincesSelector",multiple:!0,data:e.$page.props.cities.filter(s=>s.level==1),label:e.__("supported_provinces"),error:o.form.errors.supported_provinces,id:"supported_provinces",modelValue:o.form.supported_provinces,"onUpdate:modelValue":t[2]||(t[2]=s=>o.form.supported_provinces=s)},{append:a(()=>[r("div",xe,[n(_,{class:"h-5 w-5"})])]),_:1},8,["data","label","error","modelValue"])])):l("",!0),o.form.type_id?(d(),h("div",Ie,[n(f,{ref:"parentSelector",data:o.filteredAgencies,label:e.__("parent_agency"),error:o.form.errors.parent_id,id:"parent_id",modelValue:o.form.parent_id,"onUpdate:modelValue":t[3]||(t[3]=s=>o.form.parent_id=s)},{append:a(()=>[r("div",Se,[n(_,{class:"h-5 w-5"})])]),_:1},8,["data","label","error","modelValue"])])):l("",!0),r("div",ke,[n(y,{id:"name",type:"text",placeholder:e.__("name"),classes:"  ",modelValue:o.form.name,"onUpdate:modelValue":t[4]||(t[4]=s=>o.form.name=s),autocomplete:"name",error:o.form.errors.name},{prepend:a(()=>[r("div",Ve,[n(g,{class:"h-5 w-5"})])]),_:1},8,["placeholder","modelValue","error"])]),r("div",$e,[n(y,{id:"phone",type:"tel",placeholder:e.__("phone"),classes:"  ",modelValue:o.form.phone,"onUpdate:modelValue":t[5]||(t[5]=s=>o.form.phone=s),autocomplete:"phone",error:o.form.errors.phone},{prepend:a(()=>[r("div",Ae,[n(g,{class:"h-5 w-5"})])]),_:1},8,["placeholder","modelValue","error"])]),l("",!0),r("div",Be,[n(x,{ref:"addressSelector",editable:!0,clearable:!0,class:"",type:"",label:e.__("address"),onChange:t[7]||(t[7]=s=>p.updateAddress(s)),error:o.form.errors.address||o.form.errors.postal_code||o.form.errors.province_id||o.form.errors.county_id},null,8,["label","error"])]),o.form.progress?(d(),h("div",Ce,[r("div",{class:b(["bg-primary rounded text-xs leading-none py-[.1rem] text-center text-white duration-300",{" animate-pulse":o.form.progress.percentage<100}]),style:U(`width: ${o.form.progress.percentage}%`)},[r("span",Pe,c(o.form.progress.percentage),1)],6)])):l("",!0),r("div",Ue,[n(S,{onClick:p.submit,type:"button",class:b(["w-full flex items-center justify-center",{"opacity-25":o.form.processing}]),disabled:o.form.processing},{default:a(()=>[o.form.processing?(d(),v(I,{key:0,class:"w-4 h-4 mx-3"})):l("",!0),r("span",Te,c(e.__("register_info")),1)]),_:1},8,["onClick","class","disabled"])])],32)])])])]),_:1})}const zo=W(ce,[["render",Ee]]);export{zo as default};
