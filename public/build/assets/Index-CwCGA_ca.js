import"./Scaffold-DWvcdxbt.js";import{P as I}from"./Panel-B14SxVgH.js";import{Z as P,j as B,i as d,o as g,c as A,w as p,a as t,t as i,b as l,g as E,f as u,e as h,h as m,F as f,k as V,G as N,J as j,n as M}from"./app-COCv_6FM.js";import{P as U,r as T}from"./Pagination-B7Lk-YHC.js";import{r as L,I as $}from"./Footer-B5OFFhHa.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as q}from"./ShoppingBagIcon-DdettYi9.js";import{r as z}from"./Bars2Icon-CXJclUCF.js";import{r as X}from"./MagnifyingGlassIcon-BmWdTLzH.js";import{r as F}from"./CartItemButton-ClgMcctk.js";import"./Alert-eYSKKEf0.js";import"./LoadingIcon-PyLCRR-O.js";import"./ApplicationLogo-DT4XYSyB.js";import"./Tooltip-D0OChXnj.js";import"./TextInput-K5DGNw4r.js";import"./InputLabel-DWU22C58.js";import"./WrenchScrewdriverIcon-D0loC_t3.js";import"./QuestionMarkCircleIcon-56s_3IWs.js";import"./ChevronRightIcon-B7nF-CoK.js";import"./ChevronUpIcon-BtLkJPMB.js";import"./PlusIcon-RnmXorVm.js";import"./MinusIcon-7FMvIveB.js";const H={data(){return{params:{page:1,search:null,paginate:this.$page.props.pageItems[0],order_by:null,dir:"DESC"},data:[],pagination:{},toggleSelect:!1,loading:!1,error:null}},components:{Head:P,Link:B,HomeIcon:q,ChevronDownIcon:L,Panel:I,Bars2Icon:z,Image:$,MagnifyingGlassIcon:X,XMarkIcon:F,Pagination:U,ArrowsUpDownIcon:T},mounted(){this.getData()},methods:{getData(){this.loading=!0,this.data=[],window.axios.get(route("panel.ticket.search"),{params:this.params},{onUploadProgress:function(e){console.log(e)},onDownloadProgress:function(e){console.log(e)}}).then(e=>{this.data=e.data.data,this.data.forEach(s=>{s.selected=!1}),delete e.data.data,this.pagination=e.data}).catch(e=>{e.response?(console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers),this.error=e.response.data):e.request?(console.log(e.request),this.error=e.request):(console.log("Error",e.message),this.error=e.message),console.log(e.config),this.showToast("danger",e)}).finally(()=>{this.loading=!1})},toggleAll(){this.toggleSelect=!this.toggleSelect,this.data.forEach(e=>{e.selected=this.toggleSelect})},edit(e){this.isLoading(!0),window.axios.patch(route("ticket.update"),e,{onUploadProgress:function(s){},onDownloadProgress:function(s){}}).then(s=>{s.data&&s.data.message&&this.showToast("success",s.data.message),s.data.charge&&(this.data[e.idx].charge=s.data.charge,this.user.wallet=s.data.wallet),s.data.status&&(this.data[e.idx].status=s.data.status),s.data.view_fee&&(this.data[e.idx].view_fee=s.data.view_fee),s.data.meta&&(this.data[e.idx].meta=s.data.meta,this.user.meta_wallet=s.data.meta_wallet)}).catch(s=>{this.error=this.getErrors(s),s.response&&s.response.data&&(s.response.data.charge&&(this.data[e.idx].charge=s.response.data.charge),s.response.data.view_fee&&(this.data[e.idx].view_fee=s.response.data.view_fee),s.response.data.meta&&(this.data[e.idx].meta=s.response.data.meta)),this.showToast("danger",this.error)}).finally(()=>{this.isLoading(!1)})},paginationChanged(e){this.params.page=e.page,this.getData()},bulkAction(e){if(this.data.filter(n=>n.selected).length==0){this.showToast("danger",this.__("nothing_selected"));return}this.isLoading(!0);const s={cmnd:e,data:this.data.reduce((n,c)=>(c.selected&&n.push(c.id),n),[])};window.axios.patch(route("ticket.update"),s,{onUploadProgress:function(n){},onDownloadProgress:function(n){}}).then(n=>{if(n.data&&n.data.message&&this.showToast("success",n.data.message),n.data&&n.data.results){const c=n.data.results;for(let a in this.data)for(let r in c)if(c[r].id==this.data[a].id){this.data[a].status=c[r].status;break}}}).catch(n=>{this.error=this.getErrors(n),this.showToast("danger",this.error)}).finally(()=>{this.isLoading(!1)})}}},K={class:"flex items-center justify-between px-4 py-2 text-primary-500 border-b md:py-4"},J={class:"flex"},Z={class:"text-2xl font-semibold"},O={class:"px-2 flex flex-col md:px-4"},Q={class:"flex-col bg-white overflow-x-auto shadow-lg rounded-lg"},R={class:"flex items-center justify-between py-4 p-4"};const W={class:"flex items-center"},Y={class:"relative mx-1","data-te-dropdown-ref":""},ee={id:"dropdownPaginate","data-te-dropdown-toggle-ref":"","aria-expanded":"false","data-te-ripple-init":"","data-te-ripple-color":"light",class:"inline-flex items-center text-gray-500 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-3 py-1.5"},te=t("span",{class:"sr-only"},"table actions",-1),se={ref:"userMenu","data-te-dropdown-menu-ref":"",class:"min-w-[12rem] absolute z-[1000] start-0 text-gray-500 m-0 hidden min-w-max list-none overflow-hidden rounded-lg border-none bg-white bg-clip-padding text-start text-base shadow-lg [&[data-te-dropdown-show]]:block",tabindex:"-1",role:"menu","aria-orientation":"vertical","aria-label":"User menu","aria-labelledby":"dropdownPaginate"},ae={class:""},oe=["onClick"],ne=t("hr",{class:"border-gray-200"},null,-1),ie={class:"relative"},re=t("label",{for:"table-search",class:"sr-only"},"Search",-1),le={class:"absolute inset-y-0 cursor-pointer text-gray-500 hover:text-gray-700 start-0 flex items-center px-3"},de=["placeholder"],ce={class:"w-full text-sm text-left text-gray-500"},ge={class:"text-xs text-gray-700 uppercase bg-gray-50"},he={class:"text-sm text-center"};const pe={class:"flex items-center justify-center"},ue={class:"px-2"},_e={class:"flex items-center justify-center"},me={class:"px-2"},fe={class:"flex items-center justify-center"},xe={class:"px-2"},be={class:""},ye={class:"animate-pulse bg-white text-center border-b hover:bg-gray-50"},we=t("td",{class:"flex justify-center items-center px-6 py-4 text-gray-900 whitespace-nowrap"},[t("div",{class:"text-base bg-gray-200 px-5 py-2 rounded-lg"})],-1),ve=t("td",{class:"px-2 py-4"},[t("div",{class:"bg-gray-200 px-5 py-2 rounded-lg"})],-1),ke=t("td",{class:"px-2 py-4"},[t("div",{class:"bg-gray-200 px-5 py-2 rounded-lg"})],-1),Ce=[we,ve,ke],De=["onClick"];const Se={class:"flex items-center px-6 py-4 text-gray-700 whitespace-nowrap"},Ie={class:"text-base text-xs font-semibold"},Pe={class:"font-normal text-gray-500"},Be={class:"px-2 py-4"},Ae={class:"px-2 py-4"},Ee={class:"inline-flex text-xs",role:"group"};function Ve(e,s,n,c,a,r){const y=d("Bars2Icon"),x=d("Link"),w=d("ChevronDownIcon"),v=d("Pagination"),k=d("MagnifyingGlassIcon"),C=d("XMarkIcon"),_=d("ArrowsUpDownIcon"),D=d("Panel");return g(),A(D,null,{header:p(()=>[t("title",null,i(e.__("panel")),1)]),content:p(()=>[t("div",K,[t("div",J,[l(y,{class:"h-7 w-7 mx-3"}),t("h1",Z,i(e.__("tickets_list")),1)]),t("div",null,[l(x,{href:e.route(`${e.isAdmin()?"admin":"user"}.panel.ticket.create`),class:"inline-flex items-center justify-center px-4 py-2 bg-green-500 border border-transparent rounded-md font-semibold transition-all duration-500 text-white hover:bg-green-600 focus:bg-gray-700 active:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition ease-in-out duration-150"},{default:p(()=>[E(i(e.__("new_ticket")),1)]),_:1},8,["href"])])]),t("div",O,[t("div",Q,[t("div",R,[u("",!0),t("div",W,[t("div",Y,[t("button",ee,[te,t("span",null,i(a.params.paginate),1),l(w,{class:"h-4 w-4 mx-1"})]),t("div",se,[(g(!0),h(f,null,m(e.$page.props.pageItems,o=>(g(),h("div",ae,[t("div",{onClick:S=>{a.params.paginate=o,r.getData()},role:"menuitem",class:"cursor-pointer select-none block p-2 px-6 text-sm transition-colors hover:bg-gray-100"},i(o),9,oe),ne]))),256))],512)]),l(v,{onPaginationChanged:r.paginationChanged,pagination:a.pagination},null,8,["onPaginationChanged","pagination"])]),t("div",ie,[re,t("div",le,[l(k,{onClick:s[0]||(s[0]=o=>r.getData()),class:"w-4 h-4"})]),t("div",{class:"absolute inset-y-0 end-0 text-gray-500 flex items-center px-3 cursor-pointer hover:text-gray-700",onClick:s[1]||(s[1]=o=>{a.params.search=null,r.getData()})},[l(C,{class:"w-4 h-4"})]),V(t("input",{type:"text",id:"table-search-users","onUpdate:modelValue":s[2]||(s[2]=o=>a.params.search=o),onKeydown:s[3]||(s[3]=j(o=>r.getData(),["enter"])),class:"block p-2 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg w-80 bg-gray-50 focus:ring-blue-500 focus:border-blue-500",placeholder:e.__("search")},null,40,de),[[N,a.params.search]])])]),t("table",ce,[t("thead",ge,[t("tr",he,[u("",!0),t("th",{scope:"col",class:"px-2 py-3 cursor-pointer duration-300 hover:text-gray-500 hover:scale-[99%]",onClick:s[6]||(s[6]=o=>{a.params.order_by="subject",a.params.dir=a.params.dir=="ASC"?"DESC":"ASC",a.params.page=1,r.getData()})},[t("div",pe,[t("span",ue,i(e.__("subject")),1),l(_,{class:"w-4 h-4"})])]),t("th",{scope:"col",class:"px-2 py-3 cursor-pointer duration-300 hover:text-gray-500 hover:scale-[99%]",onClick:s[7]||(s[7]=o=>{a.params.order_by="status",a.params.dir=a.params.dir=="ASC"?"DESC":"ASC",a.params.page=1,r.getData()})},[t("div",_e,[t("span",me,i(e.__("status")),1),l(_,{class:"w-4 h-4"})])]),t("th",{scope:"col",class:"px-2 py-3 cursor-pointer duration-300 hover:text-gray-500 hover:scale-[99%]",onClick:s[8]||(s[8]=o=>{a.params.order_by="updated_at",a.params.dir=a.params.dir=="ASC"?"DESC":"ASC",a.params.page=1,r.getData()})},[t("div",fe,[t("span",xe,i(e.__("update")),1),l(_,{class:"w-4 h-4"})])])])]),t("tbody",be,[a.loading?(g(),h(f,{key:0},m(3,o=>t("tr",ye,Ce)),64)):u("",!0),(g(!0),h(f,null,m(a.data,(o,S)=>(g(),h("tr",{onClick:b=>e.$inertia.visit(e.route("panel.ticket.edit",o.id)),class:"bg-white cursor-pointer hover:bg-gray-400 text-center border-b hover:bg-gray-50"},[u("",!0),t("td",Se,[l(x,{class:"px-3 hover:text-gray-500",href:e.route("panel.ticket.edit",o.id)},{default:p(()=>[t("div",Ie,i(e.cropText(o.subject,40)),1),t("div",Pe,i(),1)]),_:2},1032,["href"])]),t("td",Be,[t("div",{id:"dropdownStatusSetting",class:M(["select-none text-xs w-fit mx-auto px-1 items-center text-center rounded-md py-[.2rem]",`bg-${e.getStatus("ticket_statuses",o.status).color}-100 hover:bg-${e.getStatus("ticket_statuses",o.status).color}-200 text-${e.getStatus("ticket_statuses",o.status).color}-500`])},i(e.getStatus("ticket_statuses",o.status).name),3)]),t("td",Ae,[t("div",Ee,i(e.toShamsi(o.updated_at,!0)),1)])],8,De))),256))])])])])]),_:1})}const st=G(H,[["render",Ve]]);export{st as default};
