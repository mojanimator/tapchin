import{T as k}from"./Tooltip-CSg56dN2.js";import{L as y}from"./LoadingIcon-8dx7WYGr.js";import{o as s,e as u,a as i,i as m,k as d,v as c,l as I,t as C,b as g,n as v,p as x,c as f,f as a}from"./app-DeJr7fNP.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as L,a as T}from"./XMarkIcon-CEnCPALs.js";function B(e,t){return s(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[i("path",{d:"M19.5 21a3 3 0 003-3v-4.5a3 3 0 00-3-3h-15a3 3 0 00-3 3V18a3 3 0 003 3h15zM1.5 10.146V6a3 3 0 013-3h5.379a2.25 2.25 0 011.59.659l2.122 2.121c.14.141.331.22.53.22H19.5a3 3 0 013 3v1.146A4.483 4.483 0 0019.5 9h-15a4.483 4.483 0 00-3 1.146z"})])}const D={props:["link","id","type","replace","height","width","required","preload","label","mode","forId","callback","images","limit","cropRatio","classes"],components:{Tooltip:k,XMarkIcon:L,CheckIcon:T,LoadingIcon:y,FolderIcon:B},data(){return{componentKey:1,star:null,doc:null,file:null,reader:null,cropper:null,loading:!1,uploading:!1,creating:!1,removing:!1,uploader:null,errors:""}},watch:{},beforeDestroy(){},computed:{},mounted(){this.image=document.getElementById("banner-"+this.id),this.uploader=document.querySelector("#banner-"+this.id+"-file"),this.uploadContainer=document.querySelector("#banner-container-"+this.id),this.preload&&(this.doc=this.preload.url)},created(){},updated(){},beforeUpdate(){},methods:{errorImage(){this.doc=null,this.uploadContainer.classList.remove("d-none")},clearImage(){return this.doc=null,this.image.src=null,this.file=null,null},refresh(){this.uploadContainer.classList.remove("d-none"),this.image.src=null},removeImage(){this.removing=!0,axios.patch(this.link,{id:this.forId,cmnd:"delete-banner",path:this.preload}).then(e=>{e.status===200?window.location.reload():this.showToast("danger",e,onclick=null)}).catch(e=>{this.errors=this.getErrors(e),this.showToast("danger",this.errors,onclick=null)}).finally(()=>{this.removing=!1})},async uploadImage(){this.uploading=!0;var e=new FormData;e.append("banner",this.file),e.append("id",this.forId),e.append("cmnd","upload-banner"),e.append("_method","PATCH"),axios.post(this.link,e).then(t=>{console.log(t.status),t.status===200?this.showToast("success",t.data.message,onclick=null):this.showToast("danger",t.data,onclick=null)}).catch(t=>{this.errors=this.getErrors(t),this.showToast("danger",this.errors,onclick=null)}).finally(()=>{this.uploading=!1})},openFileChooser(e,t){let l=document.getElementById(t);if(document.createEvent){let h=document.createEvent("MouseEvents");h.initEvent("click",!1,!0),l.dispatchEvent(h)}else{let h=new Event("click",{bubbles:!1,cancelable:!0});l.dispatchEvent(h)}},filePreview(e,t){let l;e.dataTransfer?l=e.dataTransfer.files[0]:e.target.files&&(l=e.target.files[0]),e.target.value="",this.file=l,this.doc=URL.createObjectURL(l),this.uploadContainer.classList.add("d-none")},log(e){console.log(e)}}},j={class:"h-full"},M={class:"h-full"},F=["id"],S={class:""},V={class:"p-2 small text-center"},z=["id","name"],P=["id","name"],q=i("div",{class:"absolute bg-black opacity-10 w-full h-full rounded"},null,-1),N={class:"h-[inherit]"},R=["id","src"],U={class:"backdrop-blur relative flex justify-center p-2 items-center h-32"},X=["id","src"],A=i("div",{class:"absolute bg-black opacity-10 w-full h-full rounded"},null,-1),H={class:"flex my-1 w-100",role:"group"},K=["title"],O=["title"],G=["title"];function J(e,t,l,h,n,r){const w=m("FolderIcon"),_=m("XMarkIcon"),b=m("LoadingIcon"),p=m("CheckIcon");return s(),u("div",j,[i("div",M,[d(i("div",{class:"flex h-full md:min-w-[150px] items-center justify-center uploader-container rounded-lg p-3",id:"banner-container-"+this.id,style:{border:"dashed"},role:"form",onDrop:t[1]||(t[1]=I(o=>r.filePreview(o),["prevent"])),onClick:t[2]||(t[2]=o=>r.openFileChooser(o,"banner-"+l.id+"-file"))},[i("div",S,[i("div",V,C(l.label),1)]),d((s(),u("input",{id:"banner-"+l.id+"-file",class:"w-full",accept:".png, .jpg, .jpeg",type:"file",key:l.id,name:"banner-"+l.id+"-file",onInput:t[0]||(t[0]=o=>r.filePreview(o,"banner-"+l.id+"-file"))},null,40,z)),[[c,!1]]),i("input",{id:l.id,class:"col-12",name:l.id,type:"hidden"},null,8,P)],40,F),[[c,!n.doc&&(l.mode=="edit"||l.mode=="create")]]),d(i("div",{onClick:t[3]||(t[3]=o=>e.showDialog("danger",e.__("call_owner_for_receive_file"),e.__("remove"),r.removeImage)),class:"text-primary backdrop-blur relative flex justify-center p-2 items-center h-full cursor-pointer hover:bg-gray-200"},[q,g(w,{class:"w-10 h-10"})],512),[[c,l.mode=="lock"]]),d(i("div",N,[i("img",{id:"banner-"+l.id,class:v(["",l.classes]),onError:t[4]||(t[4]=(...o)=>r.errorImage&&r.errorImage(...o)),onLoad:t[5]||(t[5]=o=>{e.uploadContainer.classList.add("d-none")}),src:n.doc,alt:""},null,42,R)],512),[[c,n.doc&&l.mode=="view"]]),d(i("div",{class:"rounded-lg flex flex-col justify-between",style:x(`width:${l.width}`)},[i("div",U,[d(i("img",{id:"banner-"+l.id,class:v(["block absolute w-full h-full opacity-50 p-2",l.classes]),onError:t[6]||(t[6]=(...o)=>r.errorImage&&r.errorImage(...o)),onLoad:t[7]||(t[7]=o=>{e.uploadContainer.classList.add("d-none")}),src:n.doc,alt:""},null,42,X),[[c,n.doc&&l.mode!="view"]]),A,g(w,{class:"w-10 h-10 opacity-50 text-[#fff]"})]),i("div",H,[l.mode=="edit"?(s(),u("div",{key:0,class:v([n.file?" rounded-s":"rounded","text-center flex grow cursor-pointer hover:bg-danger-600 p-2 bg-danger text-white grow"]),title:e.__("remove"),onClick:t[8]||(t[8]=o=>{!l.preload||l.replace?r.clearImage():e.showDialog("danger",e.__("remove_image?"),e.__("remove"),r.removeImage)})},[n.removing?a("",!0):(s(),f(_,{key:0,class:"w-4 h-4 mx-auto text-white text-white"})),n.removing?(s(),f(b,{key:1,class:"w-4 h-4 mx-auto"})):a("",!0)],10,K)):a("",!0),l.mode=="edit"&&n.file?(s(),u("div",{key:1,class:"cursor-pointer grow rounded-e hover:bg-success-600 p-2 bg-success text-white grow",title:e.__("upload"),onClick:t[9]||(t[9]=o=>e.showDialog("primary",e.__("new_file_replace_and_active_after_review"),e.__("upload"),r.uploadImage))},[n.uploading?a("",!0):(s(),f(p,{key:0,class:"w-4 h-4 mx-auto text-white text-white"})),n.uploading?(s(),f(b,{key:1,class:"w-4 h-4 mx-auto"})):a("",!0)],8,O)):a("",!0),l.mode!="edit"?(s(),u("div",{key:2,class:"cursor-pointer bg-danger hover:bg-danger-600 p-2 text-white grow rounded-lg",title:e.__("remove"),onClick:t[10]||(t[10]=o=>r.refresh())},[g(_,{class:"w-4 h-4 mx-auto text-white text-white"})],8,G)):a("",!0)])],4),[[c,n.doc&&l.mode!="view"]])])])}const ee=E(D,[["render",J]]);export{ee as B};
