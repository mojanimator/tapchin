import"./Scaffold-D_ifbLkl.js";import{P as E,r as D}from"./Panel-rs2tkraC.js";import{T as y,Z as F,j as q,D as z,i as l,o as a,c as k,w as g,a as e,t as o,b as d,e as n,n as p,g as x,F as b,h as w,f as c,l as A,p as H}from"./app-DeJr7fNP.js";import"./GuestLayout-B84nh8OP.js";import{_ as N,a as V}from"./InputLabel-C2gVT93H.js";import{_ as X}from"./PrimaryButton-Fk5jf8Nh.js";import{_ as O}from"./TextInput-BUWn7uYR.js";import{L as Q}from"./LoadingIcon-8dx7WYGr.js";import{P as U}from"./Popover-BaS0lwjX.js";import{T as Z}from"./Tooltip-CSg56dN2.js";import{S as G}from"./Selector-NdNaM2dQ.js";import{T as J}from"./TextEditor-7zAQTOol.js";import{r as K,I as R}from"./Footer-BYUJXMx0.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as Y}from"./ShoppingBagIcon-zIu7FSuq.js";import{r as ee}from"./Alert-CDDSmLjy.js";import{r as te}from"./EyeIcon-DI71KuzS.js";import{r as se}from"./FolderPlusIcon-oBdmLyEF.js";import{r as oe}from"./Bars2Icon-DNQAv7Yb.js";import{r as re}from"./QuestionMarkCircleIcon-jeUFMgsk.js";import{r as ae}from"./Squares2X2Icon-Dviu76Pe.js";import{r as ne}from"./SignalIcon-C7ONQsBK.js";import{r as ie}from"./ChatBubbleBottomCenterTextIcon-CovOeJqa.js";import{r as le}from"./PencilIcon-BtrTq_9n.js";import{r as de}from"./CartItemButton-BUsVs_zz.js";import{r as ce}from"./PlusIcon-NsBgz0vi.js";import{r as me}from"./LinkIcon-ClPrNMD5.js";import"./ApplicationLogo-CV6pwTdm.js";import"./WrenchScrewdriverIcon-DQFoZ8JW.js";import"./ChevronUpIcon-DGI4GkYP.js";import"./MinusIcon-B-7x8Y4K.js";const pe={data(){return{modal:null,data:null,params:{ticket_id:this.$page.props.data.id},form:y({}),files:[null]}},components:{LoadingIcon:Q,Head:F,Link:q,HomeIcon:Y,ChevronDownIcon:K,Panel:E,InputLabel:N,TextInput:O,InputError:V,PrimaryButton:X,UserIcon:ee,EyeIcon:te,Popover:U,Tooltip:Z,FolderPlusIcon:se,Bars2Icon:oe,QuestionMarkCircleIcon:re,Selector:G,Squares2X2Icon:ae,PencilSquareIcon:D,SignalIcon:ne,ChatBubbleBottomCenterTextIcon:ie,PencilIcon:le,TextEditor:J,XMarkIcon:de,PlusIcon:ce,LinkIcon:me,Image:R},created(){},mounted(){this.data=this.$page.props.data;const t=document.getElementById("newTicketModal");this.modal=new z(t)},methods:{addMessage(){let t=document.querySelectorAll("input[type=file]"),i=[];for(let h in t)t[h].files&&t[h].files.length>0&&i.push(t[h].files[0]);this.params={cmnd:"add-chat",id:this.data.id,message:this.$refs.text.getData(),attachments:i,_method:"patch"},this.submit()},removeMessage(t){t._method="patch",this.submit(t)},closeTicket(){this.params={cmnd:"close",id:this.data.id,_method:"patch"},this.submit()},submit(t){this.form.clearErrors(),this.form=y(t||this.params),this.form.post(route("panel.ticket.update"),{preserveScroll:!1,onSuccess:i=>{this.$page.props.flash.status&&this.showAlert(this.$page.props.flash.status,this.$page.props.flash.message),this.$page.props.data.status&&(this.data.status=this.$page.props.data.status),this.$page.props.data.chats&&(this.data.chats=this.$page.props.data.chats),this.$nextTick(h=>{this.modal.hide(),this.files=[],this.$refs.text.setData("")})},onError:()=>{this.showToast("danger",Object.values(this.form.errors).join("<br/>"))},onFinish:i=>{this.$page.props.flash.status&&this.showAlert(this.$page.props.flash.status,this.$page.props.flash.message)}})}}},he={class:"flex items-center justify-start px-4 py-2 text-primary-500 border-b md:py-4"},ue={class:"text-2xl font-semibold"},_e={class:"px-2 md:px-4"},fe={class:"mx-auto md:max-w-3xl mt-6 py-4 overflow-hidden"},ge={key:0,class:"flex flex-col mx-2 space-y-2 col-span-2 w-full px-2"},xe={class:"flex flex-col space-y-2 p-4 rounded-lg bg-white shadow-md"},be={class:""},we={class:"text-primary-700 text-lg font-bold"},ve={class:""},ye={class:"text-gray-500"},ke={class:""},Ie={class:"text-gray-500"},$e={class:"text-primary-700 font-bold mx-2"},Te={class:""},Ce={class:"text-gray-500"},Me={class:"text-primary-700 font-bold mx-2"},Pe={class:"grid items-center grid-cols-1 sm:grid-cols-2 gap-2"},Be={key:1,class:"text-sm text-gray-400"},je={class:"relative"},Le=["onClick"],Se={key:0,class:"flex space-y-2 min-h-[10rem] flex-col justify-between items-center mx-2 border rounded-lg p-2"},Ee={class:"text-xs text-gray-400"},De=["innerHTML"],Fe={class:"mt-1"},qe={key:0,class:"border-b my-4"},ze={key:1,class:"mt-2 text-gray-700"},Ae=["href"],He={"data-te-modal-init":"",class:"fixed left-0 top-0 backdrop-blur z-[1055] hidden h-full w-full overflow-y-auto overflow-x-hidden outline-none",id:"newTicketModal",tabindex:"-1","aria-labelledby":"newTicketModalLabel","aria-hidden":"true"},Ne={"data-te-modal-dialog-ref":"",class:"pointer-events-none relative w-auto translate-y-[-50px] opacity-0 transition-all duration-300 ease-in-out min-[576px]:mx-auto min-[576px]:mt-7 px-2 sm:px-4 md:px8 min-[576px]:max-w-5xl"},Ve={class:"min-[576px]:shadow-[0_0.5rem_1rem_rgba(#000, 0.15)] pointer-events-auto relative flex w-full flex-col rounded-md border-none bg-white bg-clip-padding text-current shadow-lg outline-none"},Xe={class:"flex flex-shrink-0 items-center justify-between rounded-t-md border-b-2 border-neutral-100 border-opacity-100 p-4"},Oe=e("h5",{class:"text-xl font-medium leading-normal text-neutral-800",id:"newTicketModalLabel"},null,-1),Qe=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-6 w-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),Ue=[Qe],Ze={class:"relative flex-auto p-4","data-te-modal-body-ref":""},Ge={class:"flex items-center justify-start px-4 py-2 text-primary-500 border-b md:py-4"},Je={class:"text-2xl font-semibold"},Ke={class:"px-2 md:px-4"},Re={class:"mx-auto md:max-w-3xl mt-6 px-2 md:px-4 py-4 bg-white shadow-md overflow-hidden rounded-lg"},We={class:"flex flex-col mx-2 col-span-2 w-full px-2"},Ye={class:"my-2"},et={key:0,class:"shadow w-full bg-grey-light m-2 bg-gray-200 rounded-full"},tt={class:"animate-bounce"},st={class:"my-4 flex flex-col"},ot={class:"flex items-center"},rt={class:"text-gray-700 my-2"},at=e("div",{class:"border-b w-full mb-2"},null,-1),nt={class:"flex justify-between items-center"},it=["id","accept"],lt={class:"mt-4"},dt={class:"text-lg"};function ct(t,i,h,mt,s,u){const I=l("PencilSquareIcon"),$=l("ChatBubbleBottomCenterTextIcon"),f=l("XMarkIcon"),T=l("Image"),C=l("LinkIcon"),M=l("FolderPlusIcon"),P=l("TextEditor"),B=l("PlusIcon"),j=l("LoadingIcon"),L=l("PrimaryButton"),S=l("Panel");return a(),k(S,null,{header:g(()=>[e("title",null,o(t.__("ticket")),1)]),content:g(()=>[e("div",he,[d(I,{class:"h-7 w-7 mx-3"}),e("h1",ue,o(t.__("ticket")+" "+(s.data?s.data.id:"")),1)]),e("div",_e,[e("div",fe,[s.data?(a(),n("div",ge,[e("div",xe,[e("div",be,[e("span",we,o(s.data.subject),1)]),e("div",ve,[e("span",ye,o(t.__("status"))+":",1),e("span",{class:p(["font-bold mx-2",`text-${t.getStatus("ticket",s.data.status).color}-700`])},o(t.__(s.data.status)),3)]),e("div",ke,[e("span",Ie,o(t.__("id"))+":",1),e("span",$e,"#"+o(s.data.id),1)]),e("div",Te,[e("span",Ce,o(t.__("created_at"))+":",1),e("span",Me,o(t.toShamsi(s.data.created_at,!0)),1)]),e("div",Pe,[e("button",{type:"button",onClick:i[0]||(i[0]=r=>s.modal.show()),"data-te-toggle":"modal","data-te-target":"#newTicketModal","data-te-ripple-init":"",class:"grow flex items-center justify-center py-1 cursor-pointer px-2 bg-success hover:bg-success-400 text-white rounded"},[x(o(t.__("response"))+" ",1),d($,{class:"h-4 w-4 mx-2 text-white"})]),s.data.status!="closed"?(a(),n("button",{key:0,type:"button",onClick:i[1]||(i[1]=r=>t.showDialog("danger",t.__("close_ticket?"),t.__("close_ticket"),u.closeTicket)),class:"grow flex items-center justify-center py-1 cursor-pointer px-2 bg-danger hover:bg-danger-400 text-white rounded"},[x(o(t.__("close"))+" ",1),d(f,{class:"h-4 w-4 mx-2 text-white"})])):(a(),n("div",Be,o(t.__("send_response_for_open_ticket")),1))])]),e("div",je,[(a(!0),n(b,null,w(s.data.chats,(r,_)=>(a(),n("div",{key:r.id,class:"flex flex-col my-2 p-4 rounded-lg bg-white shadow-md"},[t.isAdmin()?(a(),n("div",{key:0,onClick:m=>t.showDialog("danger",t.__("remove_item?"),t.__("remove"),u.removeMessage,{cmnd:"del-chat",ticket_id:s.data.id,chat_id:r.id,idx:_}),class:"absolute p-2 bg-danger text-white rounded cursor-pointer hover:bg-danger-400 end-1"},[d(f,{class:"w-5 h-5"})],8,Le)):c("",!0),e("div",{class:p(["flex items-start",r.owner&&t.$page.props.auth.user.id==r.owner.id?"":"flex-row-reverse"])},[r.owner?(a(),n("div",Se,[d(T,{src:t.route("storage.users")+`/${r.owner.id}.jpg`,classes:"object-cover rounded-full h-20   "},null,8,["src"]),e("div",{class:p(["text-sm text-center text-white rounded px-2 py-1 w-full",`bg-${t.$page.props.auth.user.id==r.owner.id?"danger":"primary"}`])},o(r.owner.fullname),3),e("div",Ee,o(r.created_at),1)])):c("",!0),e("div",{class:"grow m-2 text-gray-700",innerHTML:r.message},null,8,De)],2),(a(!0),n(b,null,w(t.$page.props.attachments.filter(m=>m.includes(`${r.id}-`)),(m,v)=>(a(),n("div",Fe,[v==0?(a(),n("div",qe)):c("",!0),v==0?(a(),n("div",ze,o(t.__("attachments")),1)):c("",!0),e("a",{target:"_blank",class:"flex items-center hover:text-primary-400",href:`${t.route("storage.tickets")}/${s.data.id}/${m}`},[d(C,{class:"w-4 h-4 mx-2 font-bold"}),e("span",null,o(m),1)],8,Ae)]))),256))]))),128))])])):c("",!0)])]),e("div",He,[e("div",Ne,[e("div",Ve,[e("div",Xe,[Oe,e("button",{class:p(["text-danger","box-content rounded-none border-none hover:no-underline hover:opacity-75 focus:opacity-100 focus:shadow-none focus:outline-none"]),type:"button","data-te-modal-dismiss":"","aria-label":"Close"},Ue)]),e("div",Ze,[e("div",Ge,[d(M,{class:"h-7 w-7 mx-3"}),e("h1",Je,o(t.__("new_message")),1)]),e("div",Ke,[e("div",Re,[e("div",We,[e("form",{onSubmit:i[3]||(i[3]=A((...r)=>u.addMessage&&u.addMessage(...r),["prevent"]))},[e("div",Ye,[d(P,{label:t.__("message"),mode:"simple",lang:t.$page.props.locale,id:"editor",ref:"text"},null,8,["label","lang"])]),s.form.progress?(a(),n("div",et,[e("div",{class:p(["bg-primary rounded text-xs leading-none py-[.1rem] text-center text-white duration-300",{" animate-pulse":s.form.progress.percentage<100}]),style:H(`width: ${s.form.progress.percentage}%`)},[e("span",tt,o(s.form.progress.percentage),1)],6)])):c("",!0),e("div",st,[e("div",ot,[e("div",rt,o(t.__("attachments")),1)]),at,(a(!0),n(b,null,w(s.files,(r,_)=>(a(),n("div",null,[e("div",nt,[e("input",{id:`attachment-${_}`,class:"w-full my-1",accept:t.$page.props.attachment_allowed_mimes,type:"file",name:"attachments"},null,8,it),d(f,{onClick:m=>{s.files.splice(_,1)},class:"w-6 h-6 text-danger cursor-pointer hover:scale-[112%] hover:text-danger-500"},null,8,["onClick"])])]))),256)),e("div",{class:"flex w-fit text-sm items-center text-white cursor-pointer bg-success hover:bg-success-500 rounded p-2 my-2",onClick:i[2]||(i[2]=r=>s.files.push(null))},[d(B,{class:"h-4 w-4 mx-1"}),x(" "+o(t.__("add_more")),1)])]),e("div",lt,[d(L,{class:p(["w-full justify-center items-center flex",{"opacity-25":s.form.processing}]),disabled:s.form.processing},{default:g(()=>[s.form.processing?(a(),k(j,{key:0,class:"w-4 h-4 mx-3"})):c("",!0),e("span",dt,o(t.__("register_info")),1)]),_:1},8,["class","disabled"])])],32)])])])])])])])]),_:1})}const Xt=W(pe,[["render",ct]]);export{Xt as default};
